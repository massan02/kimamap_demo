# Supabase + Google OAuth è¨­å®šã‚¬ã‚¤ãƒ‰

**å¯¾è±¡**: 001-auth-and-navigation Phase 1
**æ‰€è¦æ™‚é–“**: ç´„20-30åˆ†

---

## ğŸ“Œ è¨­å®šã®å…¨ä½“åƒ

```
1. Google Cloud Console
   â†“ OAuth Client ID/Secretä½œæˆ

2. Supabase
   â†“ Google OAuthãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼æœ‰åŠ¹åŒ–

3. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ
   â†“ .envãƒ•ã‚¡ã‚¤ãƒ«ã«èªè¨¼æƒ…å ±ã‚’è¨­å®š

4. å‹•ä½œç¢ºèª
```

---

## ğŸ”§ Part 1: Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

### Step 1: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ãƒ­ã‚°ã‚¤ãƒ³

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ https://supabase.com/dashboard ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³
3. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

### Step 2: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ

1. **ã€ŒNew projectã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ç”»é¢å³ä¸Šã¾ãŸã¯ä¸­å¤®ã«ã‚ã‚Šã¾ã™

2. **çµ„ç¹”ã‚’é¸æŠ**
   - æ—¢å­˜ã®çµ„ç¹”ã‚’é¸æŠã€ã¾ãŸã¯ã€ŒNew organizationã€ã§æ–°è¦ä½œæˆ
   - çµ„ç¹”åï¼ˆä¾‹ï¼‰: `My Projects`

3. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã‚’å…¥åŠ›**
   ```
   Project name: kimamap-demo
   Database Password: [å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ç”Ÿæˆãƒ»ä¿å­˜]
   Region: Northeast Asia (Tokyo) ã¾ãŸã¯è¿‘ã„ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
   Pricing Plan: Free
   ```

   **âš ï¸ Database Passwordã¯å¿…ãšä¿å­˜ã—ã¦ãã ã•ã„ï¼**
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã«ä¿å­˜
   - ã¾ãŸã¯å®‰å…¨ãªå ´æ‰€ã«ãƒ¡ãƒ¢

4. **ã€ŒCreate new projectã€ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã«ã¯1-2åˆ†ã‹ã‹ã‚Šã¾ã™
   - ç·‘è‰²ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿ

### Step 3: èªè¨¼æƒ…å ±ã‚’å–å¾—

1. **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ŒSettingsã€â†’ã€ŒAPIã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

2. **ä»¥ä¸‹ã®æƒ…å ±ã‚’ã‚³ãƒ”ãƒ¼**

   **Project URL**:
   ```
   https://xxxxxxxxxxxxx.supabase.co
   ```

   **Project API keys â†’ anon public**:
   ```
   eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6...
   ```

3. **æƒ…å ±ã‚’ä¸€æ™‚çš„ã«ä¿å­˜**
   - ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚³ãƒ”ãƒ¼ã—ã¦ãŠã
   - å¾Œã§`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã—ã¾ã™

**âœ… Supabaseãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆå®Œäº†**

---

## ğŸ”§ Part 2: Google Cloud Consoleè¨­å®š

### Step 1: Google Cloud Consoleã«ã‚¢ã‚¯ã‚»ã‚¹

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ https://console.cloud.google.com/ ã«ã‚¢ã‚¯ã‚»ã‚¹
2. Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã§ãƒ­ã‚°ã‚¤ãƒ³

### Step 2: æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ

1. **ç”»é¢ä¸Šéƒ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã‚‹

2. **ã€Œæ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

3. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæƒ…å ±ã‚’å…¥åŠ›**
   ```
   ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå: kimamap-demo
   å ´æ‰€: çµ„ç¹”ãªã—ï¼ˆå€‹äººãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å ´åˆï¼‰
   ```

4. **ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ä½œæˆã«ã¯æ•°ç§’ã‹ã‹ã‚Šã¾ã™

5. **ä½œæˆã—ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é¸æŠ**
   - ç”»é¢ä¸Šéƒ¨ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã‹ã‚‰ `kimamap-demo` ã‚’é¸æŠ

### Step 3: OAuthåŒæ„ç”»é¢ã‚’è¨­å®š

1. **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€ŒOAuthåŒæ„ç”»é¢ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

2. **User Typeã‚’é¸æŠ**
   ```
   â—‰ å¤–éƒ¨ï¼ˆExternalï¼‰
   ```
   - ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯

3. **ã‚¢ãƒ—ãƒªæƒ…å ±ã‚’å…¥åŠ›ï¼ˆã‚¹ãƒ†ãƒƒãƒ—1: OAuthåŒæ„ç”»é¢ï¼‰**

   **å¿…é ˆé …ç›®**:
   ```
   ã‚¢ãƒ—ãƒªå: æ°—ã¾ã¾ã£ã·
   ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚µãƒãƒ¼ãƒˆãƒ¡ãƒ¼ãƒ«: [ã‚ãªãŸã®Gmailã‚¢ãƒ‰ãƒ¬ã‚¹]
   ã‚¢ãƒ—ãƒªã®ãƒ­ã‚´: ï¼ˆã‚¹ã‚­ãƒƒãƒ—å¯ï¼‰
   ```

   **ã‚¢ãƒ—ãƒªãƒ‰ãƒ¡ã‚¤ãƒ³**ï¼ˆã™ã¹ã¦ã‚¹ã‚­ãƒƒãƒ—å¯ï¼‰:
   ```
   ã‚¢ãƒ—ãƒªã®ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸: ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰
   ã‚¢ãƒ—ãƒªã®ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼: ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰
   ã‚¢ãƒ—ãƒªã®åˆ©ç”¨è¦ç´„: ï¼ˆã‚¹ã‚­ãƒƒãƒ—ï¼‰
   ```

   **æ‰¿èªæ¸ˆã¿ãƒ‰ãƒ¡ã‚¤ãƒ³**:
   ```
   supabase.co
   ```
   - ã€Œãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ `supabase.co` ã‚’è¿½åŠ 

   **ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ãƒ¼ã®é€£çµ¡å…ˆæƒ…å ±**:
   ```
   ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: [ã‚ãªãŸã®Gmailã‚¢ãƒ‰ãƒ¬ã‚¹]
   ```

4. **ã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

5. **ã‚¹ã‚³ãƒ¼ãƒ—ï¼ˆã‚¹ãƒ†ãƒƒãƒ—2ï¼‰**
   - **ä½•ã‚‚è¿½åŠ ã›ãšã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

6. **ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆã‚¹ãƒ†ãƒƒãƒ—3ï¼‰**
   - **ã€Œ+ ADD USERSã€ã‚’ã‚¯ãƒªãƒƒã‚¯**
   - ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼ˆã‚ãªãŸã®Gmailï¼‰ã‚’è¿½åŠ 
   - ã€Œè¿½åŠ ã€â†’ã€Œä¿å­˜ã—ã¦æ¬¡ã¸ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

7. **æ¦‚è¦ï¼ˆã‚¹ãƒ†ãƒƒãƒ—4ï¼‰**
   - å†…å®¹ã‚’ç¢ºèª
   - **ã€Œãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

### Step 4: OAuth 2.0 Client IDã‚’ä½œæˆ

1. **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ŒAPIã¨ã‚µãƒ¼ãƒ“ã‚¹ã€â†’ã€Œèªè¨¼æƒ…å ±ã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

2. **ç”»é¢ä¸Šéƒ¨ã€Œ+ èªè¨¼æƒ…å ±ã‚’ä½œæˆã€â†’ã€ŒOAuth 2.0 ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆIDã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

3. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ã‚’é¸æŠ**
   ```
   ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡: ã‚¦ã‚§ãƒ–ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
   åå‰: Kimamap Web Client
   ```

4. **æ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIã‚’è¿½åŠ **

   **âš ï¸ é‡è¦: ã“ã“ã§Supabaseã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯URLãŒå¿…è¦ã§ã™**

   **Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§ç¢ºèª**:
   - Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ Settings â†’ API
   - Project URL: `https://xxxxxxxxxxxxx.supabase.co`
   - `xxxxxxxxxxxxx` ã®éƒ¨åˆ†ã‚’ã‚³ãƒ”ãƒ¼

   **Google Cloud Consoleã«æˆ»ã‚‹**:
   - ã€Œæ‰¿èªæ¸ˆã¿ã®ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆURIã€â†’ã€Œ+ URIã‚’è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
   - ä»¥ä¸‹ã®URIã‚’å…¥åŠ›ï¼ˆ`xxxxxxxxxxxxx`ã‚’å®Ÿéš›ã®Project Refã«ç½®ãæ›ãˆï¼‰:
   ```
   https://xxxxxxxxxxxxx.supabase.co/auth/v1/callback
   ```

5. **ã€Œä½œæˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

6. **Client IDã¨Client Secretã‚’ã‚³ãƒ”ãƒ¼**

   **ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™**:
   ```
   ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆID: 123456789-abcdefg.apps.googleusercontent.com
   ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆ: GOCSPX-xxxxxxxxxxxxxxxx
   ```

   **âš ï¸ å¿…ãšä¸¡æ–¹ã‚³ãƒ”ãƒ¼ã—ã¦ä¿å­˜ã—ã¦ãã ã•ã„ï¼**
   - ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚³ãƒ”ãƒ¼
   - ã¾ãŸã¯ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã§JSONä¿å­˜

**âœ… Google Cloud Consoleè¨­å®šå®Œäº†**

---

## ğŸ”§ Part 3: Supabaseã§Google OAuthæœ‰åŠ¹åŒ–

### Step 1: Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«æˆ»ã‚‹

1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ï¼ˆhttps://supabase.com/dashboardï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `kimamap-demo` ã‚’é¸æŠ

### Step 2: Google OAuthãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ã‚’æœ‰åŠ¹åŒ–

1. **å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã€ŒAuthenticationã€â†’ã€ŒProvidersã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

2. **ã€ŒGoogleã€ã‚’æ¢ã—ã¦ã‚¯ãƒªãƒƒã‚¯**
   - ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ä¸€è¦§ã‹ã‚‰Googleã‚’é¸æŠ

3. **ã€ŒEnable Sign in with Googleã€ã‚’ONã«ã™ã‚‹**
   - ãƒˆã‚°ãƒ«ã‚¹ã‚¤ãƒƒãƒã‚’ã‚¯ãƒªãƒƒã‚¯

4. **Googleèªè¨¼æƒ…å ±ã‚’å…¥åŠ›**

   **Client IDï¼ˆGoogle Cloud Consoleã§å–å¾—ï¼‰**:
   ```
   123456789-abcdefg.apps.googleusercontent.com
   ```

   **Client Secretï¼ˆGoogle Cloud Consoleã§å–å¾—ï¼‰**:
   ```
   GOCSPX-xxxxxxxxxxxxxxxx
   ```

5. **Redirect URLã‚’ç¢ºèª**
   - è‡ªå‹•çš„ã«è¡¨ç¤ºã•ã‚Œã‚‹ä»¥ä¸‹ã®URLã‚’ç¢ºèª:
   ```
   https://xxxxxxxxxxxxx.supabase.co/auth/v1/callback
   ```
   - ã“ã®URLãŒGoogle Cloud Consoleã®Authorized redirect URIsã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹ã‹å†ç¢ºèª

6. **ã€ŒSaveã€ã‚’ã‚¯ãƒªãƒƒã‚¯**

**âœ… Supabase Google OAuthè¨­å®šå®Œäº†**

---

## ğŸ”§ Part 4: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã®è¨­å®š

### Step 1: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ

1. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆã§`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ**
   ```bash
   cd /home/user/kimamap_demo
   touch .env
   ```

2. **`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã«ä»¥ä¸‹ã‚’è¨˜è¼‰**
   ```bash
   # Supabaseè¨­å®š
   EXPO_PUBLIC_SUPABASE_URL=https://xxxxxxxxxxxxx.supabase.co
   EXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
   ```

   **ç½®ãæ›ãˆã‚‹å€¤**:
   - `xxxxxxxxxxxxx`: ã‚ãªãŸã®Supabase Project Ref
   - `eyJhbGci...`: ã‚ãªãŸã®Supabase Anon Keyï¼ˆPart 1 Step 3ã§å–å¾—ï¼‰

3. **`.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜**

4. **`.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒ`.gitignore`ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª**
   ```bash
   grep ".env" .gitignore
   ```

   **å‡ºåŠ›ä¾‹**:
   ```
   .env
   .env.local
   ```

**âœ… ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒè¨­å®šå®Œäº†**

---

## âœ… è¨­å®šå®Œäº†ã®ç¢ºèªãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Supabase

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `kimamap-demo` ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] Project URLã‚’å–å¾—æ¸ˆã¿ï¼ˆ`https://xxxxx.supabase.co`ï¼‰
- [ ] Anon Keyã‚’å–å¾—æ¸ˆã¿ï¼ˆ`eyJhbGci...`ï¼‰
- [ ] Google OAuthãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼ãŒæœ‰åŠ¹åŒ–ã•ã‚Œã¦ã„ã‚‹ï¼ˆç·‘è‰²ã®ãƒˆã‚°ãƒ«ï¼‰
- [ ] Google Client IDã¨Client SecretãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹

### Google Cloud Console

- [ ] ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ `kimamap-demo` ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] OAuthåŒæ„ç”»é¢ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ï¼ˆå¤–éƒ¨ãƒ»å…¬é–‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ãƒ†ã‚¹ãƒˆä¸­ï¼‰
- [ ] ãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹ï¼ˆã‚ãªãŸã®Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆï¼‰
- [ ] OAuth 2.0 Client IDãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] Authorized redirect URIsã«ä»¥ä¸‹ãŒè¿½åŠ ã•ã‚Œã¦ã„ã‚‹:
  ```
  https://xxxxxxxxxxxxx.supabase.co/auth/v1/callback
  ```

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ

- [ ] `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒä½œæˆã•ã‚Œã¦ã„ã‚‹
- [ ] `.env`ã« `EXPO_PUBLIC_SUPABASE_URL` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] `.env`ã« `EXPO_PUBLIC_SUPABASE_ANON_KEY` ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹
- [ ] `.gitignore`ã« `.env` ãŒå«ã¾ã‚Œã¦ã„ã‚‹

---

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### å•é¡Œ1: OAuthåŒæ„ç”»é¢ã§ã€Œã‚¢ãƒ—ãƒªã¯ç¢ºèªã•ã‚Œã¦ã„ã¾ã›ã‚“ã€ã‚¨ãƒ©ãƒ¼

**åŸå› **: Google OAuthåŒæ„ç”»é¢ãŒã€Œãƒ†ã‚¹ãƒˆä¸­ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

**è§£æ±ºç­–**:
1. Google Cloud Console â†’ OAuthåŒæ„ç”»é¢
2. ã€ŒTestingã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã€Œ+ ADD USERSã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ãƒ†ã‚¹ãƒˆã§ä½¿ç”¨ã™ã‚‹Googleã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’è¿½åŠ 
4. ã¾ãŸã¯ã€ŒPUBLISH APPã€ã§å…¬é–‹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã«å¤‰æ›´ï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ï¼‰

### å•é¡Œ2: Supabaseã§ã€ŒInvalid OAuth credentialsã€ã‚¨ãƒ©ãƒ¼

**åŸå› **: Client IDã¾ãŸã¯Client SecretãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºç­–**:
1. Google Cloud Console â†’ èªè¨¼æƒ…å ±
2. ä½œæˆã—ãŸOAuth 2.0 Client IDã‚’ã‚¯ãƒªãƒƒã‚¯
3. Client IDã¨Client Secretã‚’å†åº¦ã‚³ãƒ”ãƒ¼
4. Supabase â†’ Authentication â†’ Providers â†’ Google
5. æ­£ã—ã„å€¤ã‚’å…¥åŠ›ã—ã¦ã€ŒSaveã€

### å•é¡Œ3: Redirect URI mismatch

**åŸå› **: Google Cloud Consoleã®Authorized redirect URIsãŒæ­£ã—ããªã„

**è§£æ±ºç­–**:
1. Supabaseãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ Settings â†’ API â†’ Project URLç¢ºèª
2. Google Cloud Console â†’ èªè¨¼æƒ…å ± â†’ OAuth 2.0 Client ID
3. Authorized redirect URIsãŒä»¥ä¸‹ã®å½¢å¼ã‹ç¢ºèª:
   ```
   https://[YOUR_PROJECT_REF].supabase.co/auth/v1/callback
   ```
4. é–“é•ã£ã¦ã„ã‚Œã°ä¿®æ­£ã—ã¦ã€Œä¿å­˜ã€

### å•é¡Œ4: `.env`ãƒ•ã‚¡ã‚¤ãƒ«ãŒèª­ã¿è¾¼ã¾ã‚Œãªã„

**åŸå› **: Expoç’°å¢ƒå¤‰æ•°ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºç­–**:
1. `.env`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã
2. ã™ã¹ã¦ã®ç’°å¢ƒå¤‰æ•°ãŒ `EXPO_PUBLIC_` ã§å§‹ã¾ã£ã¦ã„ã‚‹ã‹ç¢ºèª
3. é–“é•ã£ã¦ã„ã‚Œã°ä¿®æ­£:
   ```bash
   # âŒ é–“é•ã„
   SUPABASE_URL=...

   # âœ… æ­£ã—ã„
   EXPO_PUBLIC_SUPABASE_URL=...
   ```
4. Expoé–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’å†èµ·å‹•

---

## ğŸ“ é‡è¦ãªæƒ…å ±ã®ä¿å­˜å…ˆ

è¨­å®šå®Œäº†å¾Œã€ä»¥ä¸‹ã®æƒ…å ±ã‚’å®‰å…¨ãªå ´æ‰€ã«ä¿å­˜ã—ã¦ãã ã•ã„ï¼š

### Supabase

```
Project Name: kimamap-demo
Project URL: https://xxxxxxxxxxxxx.supabase.co
Anon Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
Database Password: [è¨­å®šã—ãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰]
```

### Google Cloud Console

```
Project Name: kimamap-demo
Client ID: 123456789-abcdefg.apps.googleusercontent.com
Client Secret: GOCSPX-xxxxxxxxxxxxxxxx
```

**æ¨å¥¨ä¿å­˜å…ˆ**:
- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ï¼ˆ1Passwordã€Bitwardenã€LastPassãªã©ï¼‰
- æš—å·åŒ–ã•ã‚ŒãŸãƒ¡ãƒ¢ã‚¢ãƒ—ãƒª
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«ï¼ˆNotionã€Obsidianãªã©ï¼‰

**âš ï¸ Gitã«ã‚³ãƒŸãƒƒãƒˆã—ãªã„ã§ãã ã•ã„ï¼**

---

## ğŸš€ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

è¨­å®šãŒå®Œäº†ã—ãŸã‚‰ã€Phase 2ï¼ˆåŸºç›¤å®Ÿè£…ï¼‰ã«é€²ã¿ã¾ã™ã€‚

**å‹•ä½œç¢ºèª**ï¼ˆPhase 2ã§å®Ÿæ–½ï¼‰:
```typescript
// app/config/supabase.ts ã‚’ä½œæˆå¾Œ
import { supabase } from './config/supabase'

const testOAuth = async () => {
  const { error } = await supabase.auth.signInWithOAuth({
    provider: 'google'
  })

  if (error) {
    console.error('OAuthè¨­å®šã‚¨ãƒ©ãƒ¼:', error.message)
  } else {
    console.log('âœ… OAuthè¨­å®šæˆåŠŸï¼')
  }
}
```

---

**ã“ã®ã‚¬ã‚¤ãƒ‰ã¯Phase 1ã®Supabase + Google OAuthè¨­å®šå°‚ç”¨ã§ã™ã€‚**
**å®Ÿè£…æ‰‹é †ã¯ `specs/001-auth-and-navigation/tasks.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚**